# Kubernetes Job ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?

‡πÉ‡∏ô Kubernetes **Job** ‡∏Ñ‡∏∑‡∏≠ *Controller* ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ "‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏™‡∏£‡πá‡∏à"
(Finite Tasks)

------------------------------------------------------------------------

## üÜö ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö Deployment vs Job

### **Deployment**

-   ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö *Running ‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤*
-   ‡∏ñ‡πâ‡∏≤ Pod ‡∏ï‡∏≤‡∏¢ ‚Üí Kubernetes ‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
-   ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö: Web Server, API, Database

### **Job**

-   ‡∏ó‡∏≥‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß *‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô* (Completed)
-   ‡∏ñ‡πâ‡∏≤ Pod ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (Exit 0) ‚Üí ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å Restart
-   ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö: Backup, ‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô, ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÑ‡∏ü‡∏•‡πå, Migration Script

------------------------------------------------------------------------

## üìù ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå YAML: Job

``` yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: my-first-job
spec:
  backoffLimit: 4
  template:
    spec:
      containers:
      - name: worker
        image: busybox
        command: ["sh", "-c", "echo 'Start working'; for i in 1 2 3 4 5; do echo Processing $i...; sleep 1; done; echo 'Job Done!'"]
      restartPolicy: OnFailure
```

### üîç ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á `restartPolicy`

  ‡∏Ñ‡πà‡∏≤             ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢
  --------------- -----------------------------------------------
  **OnFailure**   Restart ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≠‡∏ô‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏á
  **Never**       ‡∏ñ‡πâ‡∏≤‡∏û‡∏±‡∏á‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á Pod ‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏ó‡∏ô ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ Pod ‡πÄ‡∏î‡∏¥‡∏°
  **Always**      ‚ùå ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö Job

------------------------------------------------------------------------

## üß™ Lab: ‡∏™‡∏£‡πâ‡∏≤‡∏á Job ‡∏á‡πà‡∏≤‡∏¢‡πÜ

1.  ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `simple-job.yaml`

2.  ‡πÉ‡∏™‡πà‡πÇ‡∏Ñ‡πâ‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏•‡∏á‡πÑ‡∏õ

3.  ‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á

    ``` bash
    kubectl apply -f simple-job.yaml
    ```

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞

``` bash
kubectl get jobs
kubectl get pods
```

‡πÉ‡∏ô‡πÑ‡∏°‡πà‡∏Å‡∏µ‡πà‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ Pod ‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å **Running ‚Üí Completed**

### ‡∏î‡∏π Log

``` bash
kubectl logs job/my-first-job
```

------------------------------------------------------------------------

## ‚öôÔ∏è ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡∏≠‡∏á Job

### 1. ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡∏Ç‡∏ô‡∏≤‡∏ô (Parallelism)

``` yaml
spec:
  parallelism: 3
  completions: 3
```

### 2. ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (Completions)

``` yaml
spec:
  completions: 10
```

### 3. ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡∏≤‡∏¢‡∏ï‡∏±‡∏ß (Timeout)

``` yaml
spec:
  activeDeadlineSeconds: 100
```

------------------------------------------------------------------------

## ‚è∞ CronJob (‡∏†‡∏≤‡∏Ñ‡∏ï‡πà‡∏≠‡∏Ç‡∏≠‡∏á Job)

CronJob = Job + Schedule ‡πÅ‡∏ö‡∏ö Crontab

``` yaml
apiVersion: batch/v1
kind: CronJob
metadata:
  name: daily-backup
spec:
  schedule: "0 3 * * *"
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: backup
            image: my-backup-image
            command: ["/bin/sh", "-c", "echo Backing up data..."]
          restartPolicy: OnFailure
```

------------------------------------------------------------------------

## üß© ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

  ‡πÉ‡∏ä‡πâ‡∏≠‡∏∞‡πÑ‡∏£          ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà
  ---------------- -----------------------------------------------
  **Deployment**   ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö "‡∏£‡∏±‡∏ô‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤"
  **Job**          ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô script ‡πÅ‡∏•‡πâ‡∏ß "‡∏à‡∏ö‡∏á‡∏≤‡∏ô"
  **CronJob**      ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô‡∏á‡∏≤‡∏ô‡∏ã‡πâ‡∏≥‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤ ‡πÄ‡∏ä‡πà‡∏ô ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô ‡∏ï‡∏µ 3

------------------------------------------------------------------------
